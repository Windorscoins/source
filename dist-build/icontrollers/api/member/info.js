var _0x1e23=['getCoinExchange','extend','pick','email','fullname','memwallet','syswallet','address','coinwallet','path','isIni','auto_withdraw_comfirm','sold','price','max','date','./../../../models/SysConfig','./../../../models/CoinConfig','./../../../config/config','moment-timezone','./../../../models/MemberBalance','./../../../models/MemberStatistics','./../../../models/Member','jsonwebtoken','./../../../libraries/LbCoin','underscore','exports','verify','jwt','username','password','addMemberSocket','findById','balance','startOf','day','valueOf','findOne','_id','stringify','findAllQ','length','forEach','qty','GetValue'];(function(_0x54b142,_0x1cf3cb){var _0x2831e7=function(_0x1985b9){while(--_0x1985b9){_0x54b142['push'](_0x54b142['shift']());}};_0x2831e7(++_0x1cf3cb);}(_0x1e23,0xc4));var _0x31e2=function(_0x36b736,_0x1949d6){_0x36b736=_0x36b736-0x0;var _0x5283e4=_0x1e23[_0x36b736];return _0x5283e4;};'use strict';const SysConfig=require(_0x31e2('0x0'));const CoinConfig=require(_0x31e2('0x1'));const Config=require(_0x31e2('0x2'));const moment=require(_0x31e2('0x3'));const MemberBalance=require(_0x31e2('0x4'));const MemberStatistics=require(_0x31e2('0x5'));const Member=require(_0x31e2('0x6'));const JWT=require(_0x31e2('0x7'));const LbSocket=require('./../../../libraries/LbSocket');const MemberBuyCoin=require('./../../../models/MemberBuyCoin');const MemberBuyICOOrder=require('./../../../models/MemberBuyICOOrder');const LbCoin=require(_0x31e2('0x8'));const _=require(_0x31e2('0x9'));module[_0x31e2('0xa')]=(_0x9e653d,_0x19533b)=>{return(_0x75fa0d,_0x504c88)=>{if(_0x75fa0d&&_0x75fa0d['token']){JWT[_0x31e2('0xb')](_0x75fa0d['token'],Config[_0x31e2('0xc')],(_0x165123,_0x42af27)=>{if(_0x42af27&&_0x42af27[_0x31e2('0xd')]&&_0x42af27[_0x31e2('0xe')]){Member['findOne']({'username':_0x42af27['username'],'active':!![]},(_0x4d33e9,_0x162013)=>{if(_0x162013){JWT[_0x31e2('0xb')](_0x162013[_0x31e2('0xe')],Config[_0x31e2('0xc')],(_0x553392,_0x52de73)=>{if(_0x52de73[_0x31e2('0xe')]==_0x42af27[_0x31e2('0xe')]){LbSocket[_0x31e2('0xf')](_0x19533b,_0x162013);MemberBalance[_0x31e2('0x10')](_0x162013[_0x31e2('0x11')],(_0x11c321,_0x268c1f)=>{MemberStatistics['findById'](_0x162013['statistics'],(_0x2c3a2e,_0x7aad4b)=>{let _0x3242fa=moment()['tz'](Config['time'])[_0x31e2('0x12')](_0x31e2('0x13'))[_0x31e2('0x14')]();MemberBuyCoin[_0x31e2('0x15')]({'date':new Date(_0x3242fa),'member':_0x162013[_0x31e2('0x16')]},(_0x504f4a,_0xafda1f)=>{let _0x3111e0=JSON['parse'](JSON[_0x31e2('0x17')](_0xafda1f));if(!_0x3111e0){_0x3111e0={'qty':0x0};}MemberBuyICOOrder[_0x31e2('0x18')]({'member':_0x162013[_0x31e2('0x16')],'active':![],'cancel':![]},(_0x45bab5,_0x4fed05)=>{if(_0x4fed05&&_0x4fed05[_0x31e2('0x19')]){_0x4fed05[_0x31e2('0x1a')](_0x4a2127=>{_0x3111e0[_0x31e2('0x1b')]+=_0x4a2127[_0x31e2('0x1b')];});}SysConfig[_0x31e2('0x1c')](_0x5b6c66=>{CoinConfig['findOne']({'date':new Date(_0x3242fa)},(_0x36a344,_0x43cee1)=>{CoinConfig[_0x31e2('0x18')]({'date':{'$gte':new Date(_0x3242fa)}},(_0x558676,_0x44a54d)=>{LbCoin[_0x31e2('0x1d')](_0x371044=>{_0x504c88({'status':!![],'member':_[_0x31e2('0x1e')](_[_0x31e2('0x1f')](_0x162013,_0x31e2('0xd'),_0x31e2('0x20'),'phone',_0x31e2('0x21'),_0x31e2('0x22'),_0x31e2('0x23'),'gender',_0x31e2('0x24'),_0x31e2('0x25'),'twoFactorActive','lv','country'),{'binaryIni':_0x162013[_0x31e2('0x26')]['binary'][_0x31e2('0x27')]}),'balance':_0x268c1f,'time':new Date()['getTime'](),'statistics':_0x7aad4b,'token':JWT['sign']({'username':_0x162013['username'],'password':_0x52de73[_0x31e2('0xe')]},Config[_0x31e2('0xc')],{'expiresIn':0x3c*0x1e}),'config':{'sysConfig':_['omit'](_0x5b6c66,_0x31e2('0x28')),'coinConfig':_['pick'](_0x43cee1,_0x31e2('0x1b'),_0x31e2('0x29'),_0x31e2('0x2a'),_0x31e2('0x2b'),_0x31e2('0x2c')),'nextCoinConfig':_[_0x31e2('0x1f')](_0x44a54d?_0x44a54d[0x0]:{},'qty',_0x31e2('0x29'),_0x31e2('0x2a'),_0x31e2('0x2b'),'date'),'memberBuyCoin':_[_0x31e2('0x1f')](_0x3111e0,_0x31e2('0x1b')),'coinRate':_0x371044}});});},0x1,0x1,{'date':0x1});});});});});});});}else{_0x504c88({'status':![]});}});}else{_0x504c88({'status':![]});}});}else{_0x504c88({'status':![]});}});}};};