var _0x4171=['_id','minus','totalSend','plus','totalReceived','storage','statistics','investment','USD','total','active','coinwallet','invest','Invest\x20','IniDirect','sendToMember','do-update-info','do-update-invest','btlNotEnoughPurchasingMore','locale','./../../../core/token','./../../../libraries/LbSocket','./../../../models/MemberBalance','./../../../models/MemberStatistics','./../../../models/MemberInvest','./../../../models/Lending','./../../../models/Tx','./../../../models/WalletAddress','./../../../config/config','./../../../models/Member','config','token','usd','findAll','length','min','max','getCoinExchange','findById','balance','coin','findOne','rootUsername','create','update'];(function(_0x3df5c8,_0x52f5a9){var _0x2a0b1d=function(_0x31a788){while(--_0x31a788){_0x3df5c8['push'](_0x3df5c8['shift']());}};_0x2a0b1d(++_0x52f5a9);}(_0x4171,0x1a9));var _0x1417=function(_0x11fc35,_0x2bbc16){_0x11fc35=_0x11fc35-0x0;var _0x12bb7a=_0x4171[_0x11fc35];return _0x12bb7a;};'use strict';const Token=require(_0x1417('0x0'));const LbSocket=require(_0x1417('0x1'));const MemberBalance=require(_0x1417('0x2'));const MemberStatistics=require(_0x1417('0x3'));const LbCoin=require('./../../../libraries/LbCoin');const MemberInvest=require(_0x1417('0x4'));const LbInvest=require('./../../../libraries/LbInvest');const Lending=require(_0x1417('0x5'));const CoinTransaction=require('./../../../models/CoinTransaction');const Tx=require(_0x1417('0x6'));const WalletAddress=require(_0x1417('0x7'));const Config=require(_0x1417('0x8'));const Member=require(_0x1417('0x9'));var bigNumber=require('bignumber.js');bigNumber[_0x1417('0xa')]({'DECIMAL_PLACES':0x8,'ERRORS':![],'ROUNDING_MODE':0x1});module['exports']=(_0x49bddd,_0x57f09e)=>{return(_0x345096,_0x1d6165)=>{if(_0x345096&&_0x345096[_0x1417('0xb')]){new Token(_0x345096[_0x1417('0xb')],_0x1de231=>{if(_0x1de231){let _0x1c24e5=+_0x345096[_0x1417('0xc')];Lending[_0x1417('0xd')]((_0x5d3e9d,_0x532ad6)=>{if(_0x532ad6&&_0x532ad6[_0x1417('0xe')]){let _0x4298dd=![];let _0x13ef61;let _0x487e87=_0x2edda1=>{if(_0x2edda1[_0x1417('0xf')]<=_0x1c24e5&&(!_0x2edda1[_0x1417('0x10')]||_0x2edda1['max']>=_0x1c24e5)&&!_0x4298dd){_0x4298dd=!![];LbCoin[_0x1417('0x11')](_0xd305ab=>{let _0x2ace86=_0x1c24e5/_0xd305ab;MemberBalance[_0x1417('0x12')](_0x1de231[_0x1417('0x13')],(_0x1a113f,_0x539848)=>{if(_0x539848&&_0x539848[_0x1417('0x14')]>=_0x2ace86){WalletAddress[_0x1417('0x15')]({'member':_0x1de231['_id']},(_0x121119,_0x176426)=>{Member[_0x1417('0x15')]({'username':Config[_0x1417('0x16')]},(_0x310730,_0xbc72ff)=>{WalletAddress[_0x1417('0x15')]({'member':_0xbc72ff['_id']},(_0x1968a0,_0x5ee53e)=>{Tx[_0x1417('0x17')]({'from':_0x176426['address'],'to':_0x5ee53e['address'],'amount':_0x2ace86,'status':0x1},()=>{WalletAddress[_0x1417('0x18')](_0x176426[_0x1417('0x19')],{'balance':new bigNumber(_0x176426[_0x1417('0x13')])[_0x1417('0x1a')](_0x2ace86),'totalSend':new bigNumber(_0x176426[_0x1417('0x1b')])[_0x1417('0x1c')](_0x2ace86)},(_0x2e0abd,_0x383aa6)=>{WalletAddress[_0x1417('0x18')](_0x5ee53e[_0x1417('0x19')],{'balance':new bigNumber(_0x5ee53e['balance'])[_0x1417('0x1c')](_0x2ace86),'totalReceived':new bigNumber(_0x5ee53e[_0x1417('0x1d')])[_0x1417('0x1c')](_0x2ace86)},(_0x354322,_0x21243a)=>{});});});});});});MemberBalance[_0x1417('0x18')](_0x1de231[_0x1417('0x13')],{'coin':new bigNumber(_0x539848['coin'])['minus'](_0x2ace86),'storage':new bigNumber(_0x539848[_0x1417('0x1e')])['minus'](_0x2ace86)},()=>{MemberStatistics[_0x1417('0x12')](_0x1de231[_0x1417('0x1f')],(_0x49ee9c,_0x120111)=>{MemberStatistics[_0x1417('0x18')](_0x1de231[_0x1417('0x1f')],{'investment.total.USD':new bigNumber(_0x120111[_0x1417('0x20')]['total'][_0x1417('0x21')])[_0x1417('0x1c')](_0x1c24e5),'investment.total.coin':new bigNumber(_0x120111[_0x1417('0x20')][_0x1417('0x22')][_0x1417('0x14')])[_0x1417('0x1c')](_0x2ace86),'investment.active.USD':new bigNumber(_0x120111[_0x1417('0x20')][_0x1417('0x23')][_0x1417('0x21')])[_0x1417('0x1c')](_0x1c24e5),'investment.active.coin':new bigNumber(_0x120111[_0x1417('0x20')][_0x1417('0x23')]['coin'])['plus'](_0x2ace86)},()=>{MemberInvest['create']({'member':_0x1de231['_id'],'lending':_0x2edda1[_0x1417('0x19')],'coin':_0x2ace86,'amount':_0x1c24e5,'capitalBack':_0x2edda1['capitalBack']},(_0x495b21,_0x3f1f4c)=>{CoinTransaction['create']({'address':_0x1de231[_0x1417('0x24')],'member':_0x1de231['_id'],'type':_0x1417('0x25'),'to':'coin','description':_0x1417('0x26')+_0x1c24e5+'$','amount':_0x2ace86,'plus':![],'foreignKey':_0x3f1f4c[_0x1417('0x19')]},(_0x458220,_0x258c6d)=>{});LbInvest[_0x1417('0x27')](_0x3f1f4c,_0x1de231);_0x1d6165({'status':!![]});LbSocket[_0x1417('0x28')](_0x1de231[_0x1417('0x19')],_0x1417('0x29'),{'update':!![]});LbSocket[_0x1417('0x28')](_0x1de231[_0x1417('0x19')],_0x1417('0x2a'),{'update':!![]});});});});});}else{_0x1d6165({'status':![],'msg':__({'phrase':_0x1417('0x2b'),'locale':_0x345096['locale']||'en'})});}});});}};_0x532ad6['forEach'](_0x484943=>{_0x487e87(_0x484943);});if(!_0x4298dd){_0x1d6165({'status':![],'msg':__({'phrase':_0x1417('0x2b'),'locale':_0x345096[_0x1417('0x2c')]||'en'})});}}else{_0x1d6165({'status':![],'msg':__({'phrase':_0x1417('0x2b'),'locale':_0x345096[_0x1417('0x2c')]||'en'})});}},0x270f,0x0,{'min':0x1});}else{_0x1d6165({'status':![],'login':!![]});}});}else{_0x1d6165({'status':![],'login':!![]});}};};