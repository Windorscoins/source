var _0x75bf=['RESIZE_HERMITE','Resize','CheckDir','existsSync','Upload_Dir','username','userfilethumbs/','originalname','rand','pipe','rename','createReadStream','keys','.svg','createWriteStream','unlinkSync','width','height','exports','jimp','mkdirp','path','image-size','./../libraries/LbUnicode','when','subClass','promise','size','extname','read','AUTO'];(function(_0xc6b72b,_0x509947){var _0x1fbca1=function(_0x37c95c){while(--_0x37c95c){_0xc6b72b['push'](_0xc6b72b['shift']());}};_0x1fbca1(++_0x509947);}(_0x75bf,0x12a));var _0xf75b=function(_0x6f8251,_0x328924){_0x6f8251=_0x6f8251-0x0;var _0x4acaaf=_0x75bf[_0x6f8251];return _0x4acaaf;};'use strict';var Jimp=require(_0xf75b('0x0'));const fs=require('fs');var mkdirp=require(_0xf75b('0x1'));const path=require(_0xf75b('0x2'));var sizeOf=require(_0xf75b('0x3'));const Config=require('./../config/config');const LbUnicode=require(_0xf75b('0x4'));var when=require(_0xf75b('0x5'));var gm=require('gm');var im=require('im');var imGm=gm[_0xf75b('0x6')]({'imageMagick':!![]});var getImageSize=function(_0x220695){return when[_0xf75b('0x7')](function(_0x4b18ff,_0x27e399){imGm(_0x220695)[_0xf75b('0x8')](function(_0x6ede75,_0x5c0d85){if(_0x6ede75){_0x27e399(_0x6ede75);}else{_0x4b18ff(_0x5c0d85);}});});};class LbImage{['r'](_0x48130c,_0x3bc7b7,_0xd59423,_0x39b2e6,_0x587668,_0x5bd159=![]){var _0x30dac8=_0x3bc7b7,_0x199595=_0xd59423;var _0x25b294=path[_0xf75b('0x9')](_0x48130c);Jimp[_0xf75b('0xa')](_0x48130c,function(_0x4d7adf,_0x21fcd4){if(_0x4d7adf)return _0x587668(_0x4d7adf);_0x21fcd4['resize'](_0x3bc7b7||Jimp[_0xf75b('0xb')],_0xd59423||Jimp['AUTO'],Jimp[_0xf75b('0xc')])['write'](_0x39b2e6,()=>{_0x587668(![]);});});}['Crop'](_0x3f327d,_0x37864f,_0x27f1bd,_0x319eca){this[_0xf75b('0xd')](_0x3f327d,_0x37864f,_0x27f1bd,_0x319eca,!![]);}[_0xf75b('0xe')](_0x208caa,_0x540e21){if(!fs[_0xf75b('0xf')](_0x208caa)){mkdirp(_0x208caa,_0x2deb3b=>{_0x540e21();});}else _0x540e21();}['UserUpload'](_0x5beb2f,_0x465e08,_0x2a6179,_0x494380){var _0x1b8a2a=Config[_0xf75b('0x10')]+'userfile/'+_0x465e08[_0xf75b('0x11')]+'/'+_0x2a6179;var _0x326091=Config[_0xf75b('0x10')]+_0xf75b('0x12')+_0x465e08['username']+'/'+_0x2a6179;this[_0xf75b('0xe')](_0x1b8a2a,()=>{this[_0xf75b('0xe')](_0x326091,()=>{if(fs[_0xf75b('0xf')](_0x1b8a2a+'/'+_0x5beb2f[_0xf75b('0x13')])){_0x5beb2f[_0xf75b('0x13')]=LbUnicode[_0xf75b('0x14')](0x3,!![])+_0x5beb2f[_0xf75b('0x13')];}var _0x270d49=path[_0xf75b('0x9')](_0x5beb2f[_0xf75b('0x13')]);try{fs['rename'](_0x5beb2f[_0xf75b('0x2')],_0x5beb2f[_0xf75b('0x2')]+_0x270d49,_0x28a3b5=>{_0x5beb2f[_0xf75b('0x2')]+=_0x270d49;fs['createReadStream'](_0x5beb2f['path'])[_0xf75b('0x15')](fs['createWriteStream'](_0x1b8a2a+'/'+_0x5beb2f['originalname']));return _0x494380(!![],_0x5beb2f[_0xf75b('0x13')]);});}catch(_0x3cbcce){}});});}[_0xf75b('0xd')](_0x44f508,_0x7c186b,_0xa5b4f6,_0x4a6b6a,_0x2a31f4=![]){if(fs[_0xf75b('0xf')](Config[_0xf75b('0x10')]+_0x7c186b+'/'+_0x44f508[_0xf75b('0x13')])){_0x44f508['originalname']=LbUnicode[_0xf75b('0x14')](0x3,!![])+_0x44f508['originalname'];}var _0x4da9aa=path['extname'](_0x44f508[_0xf75b('0x13')]);try{fs[_0xf75b('0x16')](_0x44f508[_0xf75b('0x2')],_0x44f508[_0xf75b('0x2')]+_0x4da9aa,_0x25d7f3=>{_0x44f508[_0xf75b('0x2')]+=_0x4da9aa;fs[_0xf75b('0x17')](_0x44f508['path'])[_0xf75b('0x15')](fs['createWriteStream'](Config[_0xf75b('0x10')]+_0x7c186b+'/'+_0x44f508[_0xf75b('0x13')]));var _0x417d6e=Object[_0xf75b('0x18')](_0xa5b4f6)['length'],_0x13870f=0x0,_0x3d28c7=!![];for(var _0x5cdd48 in _0xa5b4f6){if(_0x4da9aa=='svg'||_0x4da9aa==_0xf75b('0x19')){fs[_0xf75b('0x17')](_0x44f508['path'])[_0xf75b('0x15')](fs[_0xf75b('0x1a')](Config[_0xf75b('0x10')]+_0x7c186b+'/'+_0x5cdd48+'/'+_0x44f508[_0xf75b('0x13')]));_0x13870f++;if(_0x13870f==_0x417d6e){fs[_0xf75b('0x1b')](_0x44f508[_0xf75b('0x2')]);return _0x4a6b6a(![],_0x44f508[_0xf75b('0x13')]);}}else{this['r'](_0x44f508['path'],_0xa5b4f6[_0x5cdd48][_0xf75b('0x1c')],_0xa5b4f6[_0x5cdd48][_0xf75b('0x1d')],Config[_0xf75b('0x10')]+_0x7c186b+'/'+_0x5cdd48+'/'+_0x44f508[_0xf75b('0x13')],_0x1c88c7=>{if(!_0x1c88c7)_0x3d28c7=![];_0x13870f++;if(_0x13870f==_0x417d6e){fs[_0xf75b('0x1b')](_0x44f508[_0xf75b('0x2')]);return _0x4a6b6a(_0x3d28c7,_0x44f508[_0xf75b('0x13')],_0x1c88c7);}},_0x2a31f4);}}});}catch(_0x3fdeec){return _0x4a6b6a(![]);}}}module[_0xf75b('0x1e')]=new LbImage();