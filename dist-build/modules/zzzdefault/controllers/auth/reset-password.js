var _0xdb28=['codeNotValid','asyncValidationErrors','then','findOne','update','sign','jwt','findById','_id','member','catch','router','./../../../../models/Member','./../../../../config/config','jsonwebtoken','index','/check/:code.html','params','code','json','post','checkBody','password','passwordRequired','equals','body','withMessage','passwordConfirmNotValid','codeRequired'];(function(_0x23ea2a,_0x40e378){var _0x90576f=function(_0xde6c93){while(--_0xde6c93){_0x23ea2a['push'](_0x23ea2a['shift']());}};_0x90576f(++_0x40e378);}(_0xdb28,0x14b));var _0x8db2=function(_0x25b67b,_0x279f88){_0x25b67b=_0x25b67b-0x0;var _0x3d4248=_0xdb28[_0x25b67b];return _0x3d4248;};'use strict';const Core=require('./../../../../core/core');const Member=require(_0x8db2('0x0'));const Config=require(_0x8db2('0x1'));const JWT=require(_0x8db2('0x2'));class DefaultAuthResetPassword extends Core{constructor(){super();this[_0x8db2('0x3')]();}[_0x8db2('0x3')](){this['get'](_0x8db2('0x4'),(_0x1d2dd3,_0x5f42ee)=>{Member['findOne']({'passwordCode':_0x1d2dd3[_0x8db2('0x5')][_0x8db2('0x6')]},(_0x131537,_0x29f698)=>{_0x5f42ee[_0x8db2('0x7')]({'status':_0x29f698?!![]:![]});});});this[_0x8db2('0x8')]('/',(_0x126c78,_0x4ba340)=>{_0x126c78[_0x8db2('0x9')](_0x8db2('0xa'),__(_0x8db2('0xb')))['notEmpty']()[_0x8db2('0xc')](_0x126c78[_0x8db2('0xd')]['passwordConfirm'])[_0x8db2('0xe')](__(_0x8db2('0xf')));_0x126c78[_0x8db2('0x9')](_0x8db2('0x6'),__(_0x8db2('0x10')))['notEmpty']()['MemberPasswordCode']()[_0x8db2('0xe')](__(_0x8db2('0x11')));_0x126c78[_0x8db2('0x12')]()[_0x8db2('0x13')](()=>{Member[_0x8db2('0x14')]({'passwordCode':_0x126c78[_0x8db2('0xd')][_0x8db2('0x6')]},(_0x3c96a7,_0x131252)=>{if(_0x131252){Member[_0x8db2('0x15')](_0x131252['_id'],{'password':JWT[_0x8db2('0x16')]({'password':_0x126c78[_0x8db2('0xd')]['password']},Config[_0x8db2('0x17')])},()=>{Member[_0x8db2('0x18')](_0x131252[_0x8db2('0x19')],(_0x3fddc2,_0x2efd06)=>{_0x4ba340[_0x8db2('0x1a')]=_0x2efd06;this['jsonToken'](_0x126c78,_0x4ba340);});});}else{_0x4ba340['json']({'status':![],'msg':__(_0x8db2('0x11'))});}});})[_0x8db2('0x1b')](_0x1310d3=>{_0x4ba340[_0x8db2('0x7')]({'status':![],'err':_0x1310d3});});});}}module['exports']=new DefaultAuthResetPassword()[_0x8db2('0x1c')];