var _0xa9e0=['member','jsonToken','json','tokenNotValid','router','jsonwebtoken','./../../../../models/Member','index','post','body','token','password','findOne','username','verify'];(function(_0x2b4d76,_0x47bf96){var _0x4230d8=function(_0x1cb4a6){while(--_0x1cb4a6){_0x2b4d76['push'](_0x2b4d76['shift']());}};_0x4230d8(++_0x47bf96);}(_0xa9e0,0x1a9));var _0x0a9e=function(_0x46eaac,_0x5ab7ef){_0x46eaac=_0x46eaac-0x0;var _0x530c0d=_0xa9e0[_0x46eaac];return _0x530c0d;};'use strict';const Core=require('./../../../../core/core');const JWT=require(_0x0a9e('0x0'));const Config=require('./../../../../config/config');const Member=require(_0x0a9e('0x1'));class DefaultAuthToken extends Core{constructor(){super();this[_0x0a9e('0x2')]();}[_0x0a9e('0x2')](){this[_0x0a9e('0x3')]('/',(_0x981158,_0x57b080)=>{let _0x219af0=_0x981158[_0x0a9e('0x4')][_0x0a9e('0x5')];if(_0x219af0){try{JWT['verify'](_0x219af0,Config['jwt'],(_0xe42b77,_0x56465b)=>{if(_0x56465b&&_0x56465b['username']&&_0x56465b[_0x0a9e('0x6')]){Member[_0x0a9e('0x7')]({'username':_0x56465b[_0x0a9e('0x8')],'active':!![]},(_0x3ab53f,_0xfeb75b)=>{if(_0xfeb75b){JWT[_0x0a9e('0x9')](_0xfeb75b['password'],Config['jwt'],(_0x527cdd,_0x4cfe67)=>{if(_0x4cfe67[_0x0a9e('0x6')]==_0x56465b[_0x0a9e('0x6')]){_0x981158[_0x0a9e('0xa')]=_0xfeb75b;this[_0x0a9e('0xb')](_0x981158,_0x57b080);}else{_0x57b080[_0x0a9e('0xc')]({'status':![],'msg':__(_0x0a9e('0xd'))});}});}else{_0x57b080['json']({'status':![],'msg':__(_0x0a9e('0xd'))});}});}else{_0x57b080[_0x0a9e('0xc')]({'status':![],'msg':__(_0x0a9e('0xd'))});}});}catch(_0x281129){_0x57b080[_0x0a9e('0xc')]({'status':![],'msg':__(_0x0a9e('0xd'))});}}else{_0x57b080['json']({'status':![],'msg':__(_0x0a9e('0xd'))});}});}}module['exports']=new DefaultAuthToken()[_0x0a9e('0xe')];