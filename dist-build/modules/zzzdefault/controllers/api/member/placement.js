var _0x2dc3=['findById','countQ','extend','push','all','then','get','findAllQ','forEach','address','balance','statistics','exports','router','./../../../../../core/core','./../../../../../models/Member','./../../../../../models/MemberBalance','./../../../../../models/MemberStatistics','index','/:id.html','params','member','clone','pick','username','phone','email','_id','create'];(function(_0x56e983,_0x32c0df){var _0x119ca2=function(_0xd8e5aa){while(--_0xd8e5aa){_0x56e983['push'](_0x56e983['shift']());}};_0x119ca2(++_0x32c0df);}(_0x2dc3,0x14d));var _0x32dc=function(_0x19a4d6,_0x32a493){_0x19a4d6=_0x19a4d6-0x0;var _0x126224=_0x2dc3[_0x19a4d6];return _0x126224;};'use strict';const Core=require(_0x32dc('0x0'));const Member=require(_0x32dc('0x1'));const MemberBalance=require(_0x32dc('0x2'));const MemberStatistics=require(_0x32dc('0x3'));class AdminMemberPlacement extends Core{constructor(){super();this[_0x32dc('0x4')]();}['index'](){this['get'](_0x32dc('0x5'),(_0x58b6ba,_0x1f59d3)=>{Member['findAllQ']({'referralid':_0x58b6ba[_0x32dc('0x6')]['id'],'path.placement':new RegExp(String(_0x58b6ba['member']['_id']),'i'),'_id':{'$ne':_0x58b6ba[_0x32dc('0x7')]['_id']}},(_0x21438d,_0x335ab1)=>{let _0x342eec=[];if(!_0x335ab1){return _0x1f59d3['json']({'status':![]});}_0x335ab1['forEach']((_0x3f5db8,_0x3ae893)=>{let _0x346680=this[_0x32dc('0x8')](_0x3f5db8);let _0x2d9ebe=this['_'][_0x32dc('0x9')](_0x3f5db8,_0x32dc('0xa'),'fullname',_0x32dc('0xb'),'address',_0x32dc('0xc'),_0x32dc('0xd'),_0x32dc('0xe'),'referralid');let _0x355d98=new Promise((_0x10f169,_0x5e373a)=>{MemberBalance[_0x32dc('0xf')](_0x3f5db8['balance'],(_0x2dee08,_0x5954f3)=>{MemberStatistics['findById'](_0x3f5db8['statistics'],(_0x2e1a9d,_0x328940)=>{Member[_0x32dc('0x10')]({'referralid':_0x2d9ebe['_id']},_0x284dfe=>{_0x2d9ebe=this['_'][_0x32dc('0x11')]({'statistics':this[_0x32dc('0x8')](_0x328940),'sub':_0x284dfe},_0x2d9ebe);_0x2d9ebe=this['_']['extend'](this[_0x32dc('0x8')](_0x5954f3),_0x2d9ebe);_0x335ab1[_0x3ae893]=_0x2d9ebe;_0x10f169();});});});});_0x342eec[_0x32dc('0x12')](_0x355d98);});Promise[_0x32dc('0x13')](_0x342eec)[_0x32dc('0x14')](()=>{_0x1f59d3['json']({'members':_0x335ab1,'status':!![]});});});});this[_0x32dc('0x15')]('/',(_0x46249a,_0xe382d0)=>{Member[_0x32dc('0x16')]({'referralid':_0x46249a[_0x32dc('0x7')][_0x32dc('0xd')],'path.placement':new RegExp(String(_0x46249a[_0x32dc('0x7')][_0x32dc('0xd')]),'i'),'_id':{'$ne':_0x46249a['member'][_0x32dc('0xd')]}},(_0x37e2d1,_0xd8dd68)=>{let _0x2a4bf9=[];if(!_0xd8dd68){return _0xe382d0['json']({'status':![]});}_0xd8dd68[_0x32dc('0x17')]((_0x3582af,_0x36398c)=>{let _0x39182b=this['clone'](_0x3582af);let _0x36a190=this['_'][_0x32dc('0x9')](_0x3582af,_0x32dc('0xa'),'fullname','phone',_0x32dc('0x18'),'email',_0x32dc('0xd'),'create','referralid');let _0x50ccf4=new Promise((_0x2664db,_0x4a1e63)=>{MemberBalance[_0x32dc('0xf')](_0x3582af[_0x32dc('0x19')],(_0x58a46c,_0x2cbe2a)=>{MemberStatistics[_0x32dc('0xf')](_0x3582af[_0x32dc('0x1a')],(_0xa37191,_0x287bb2)=>{Member[_0x32dc('0x10')]({'referralid':_0x36a190[_0x32dc('0xd')]},_0x53dd9e=>{_0x36a190=this['_'][_0x32dc('0x11')]({'statistics':this[_0x32dc('0x8')](_0x287bb2),'sub':_0x53dd9e},_0x36a190);_0x36a190=this['_']['extend'](this['clone'](_0x2cbe2a),_0x36a190);_0xd8dd68[_0x36398c]=_0x36a190;_0x2664db();});});});});_0x2a4bf9[_0x32dc('0x12')](_0x50ccf4);});Promise['all'](_0x2a4bf9)[_0x32dc('0x14')](()=>{_0xe382d0['json']({'members':_0xd8dd68,'status':!![]});});});});}}module[_0x32dc('0x1b')]=new AdminMemberPlacement()[_0x32dc('0x1c')];