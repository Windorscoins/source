var _0x758d=['unlinkSync','unlink','resolve','Upload_Dir','json','catch','photoOfId','Crop','verification/thumb','delete','create','ortherPhoto','findOne','photoOfAddress','btcAddress','exports','router','./../../../../../models/MemberVerification','./../../../../../config/config','path','tmp/','index','postM','/passport.html','single','file','checkBody','photoNotValid','image','checkMemberVerification','passport','member','_id','asyncValidationErrors','then','verification'];(function(_0x575d6d,_0x7c562a){var _0x1e99d2=function(_0x486ab4){while(--_0x486ab4){_0x575d6d['push'](_0x575d6d['shift']());}};_0x1e99d2(++_0x7c562a);}(_0x758d,0x155));var _0xd758=function(_0x743322,_0x273d3f){_0x743322=_0x743322-0x0;var _0xdeacd0=_0x758d[_0x743322];return _0xdeacd0;};'use strict';const Core=require('./../../../../../core/core');const MemberVerification=require(_0xd758('0x0'));var Multer=require('multer');const fs=require('fs');const Config=require(_0xd758('0x1'));const LbImage=require('./../../../../../libraries/LbImage');const path=require(_0xd758('0x2'));var upload=Multer({'dest':Config['Upload_Dir']+_0xd758('0x3')});class DefaultMemberPhotoVerification extends Core{constructor(){super();this['index']();}[_0xd758('0x4')](){this[_0xd758('0x5')](_0xd758('0x6'),upload[_0xd758('0x7')](_0xd758('0x8')),(_0x10c220,_0x1cd7df)=>{_0x10c220[_0xd758('0x9')](_0xd758('0x8'),__(_0xd758('0xa')))[_0xd758('0xb')](_0x10c220[_0xd758('0x8')],!![])[_0xd758('0xc')](_0xd758('0xd'),_0x10c220[_0xd758('0xe')][_0xd758('0xf')]);_0x10c220[_0xd758('0x10')]()[_0xd758('0x11')](()=>{LbImage['Crop'](_0x10c220[_0xd758('0x8')],_0xd758('0x12'),{'thumb':{'width':0x96,'height':![]}},(_0x485491,_0x5a355d)=>{if(_0x485491){if(_0x10c220[_0xd758('0x8')]){fs[_0xd758('0x13')](_0x10c220['file']['path']);}_0x1cd7df['json']({'status':![],'msg':_0x485491});}else{MemberVerification['findOne']({'member':_0x10c220[_0xd758('0xe')]['_id'],'type':_0xd758('0xd')},(_0x10c446,_0x101964)=>{try{if(_0x101964){fs[_0xd758('0x14')](path[_0xd758('0x15')](Config[_0xd758('0x16')],'verification/thumb',_0x101964[_0xd758('0xb')]),()=>{});fs[_0xd758('0x14')](path[_0xd758('0x15')](Config[_0xd758('0x16')],_0xd758('0x12'),_0x101964['image']),()=>{});MemberVerification['delete'](_0x101964[_0xd758('0xf')],()=>{});}}catch(_0x396a5b){}MemberVerification['create']({'member':_0x10c220['member'][_0xd758('0xf')],'type':_0xd758('0xd'),'image':_0x5a355d},()=>{_0x1cd7df[_0xd758('0x17')]({'status':!![],'file':_0x5a355d});});});}});})[_0xd758('0x18')](_0x140704=>{if(_0x10c220[_0xd758('0x8')]){fs[_0xd758('0x13')](_0x10c220[_0xd758('0x8')][_0xd758('0x2')]);}_0x1cd7df['json']({'status':![],'err':_0x140704});});});this[_0xd758('0x5')]('/photo-of-id.html',upload['single'](_0xd758('0x8')),(_0x3379cb,_0x4ccc69)=>{_0x3379cb['checkBody'](_0xd758('0x8'),__(_0xd758('0xa')))[_0xd758('0xb')](_0x3379cb[_0xd758('0x8')],!![])['checkMemberVerification'](_0xd758('0x19'),_0x3379cb[_0xd758('0xe')][_0xd758('0xf')]);;_0x3379cb[_0xd758('0x10')]()[_0xd758('0x11')](()=>{LbImage[_0xd758('0x1a')](_0x3379cb[_0xd758('0x8')],_0xd758('0x12'),{'thumb':{'width':0x96,'height':![]}},(_0x278dbb,_0x23cd2f)=>{if(_0x278dbb){if(_0x3379cb[_0xd758('0x8')]){fs['unlinkSync'](_0x3379cb['file']['path']);}_0x4ccc69[_0xd758('0x17')]({'status':![],'msg':_0x278dbb});}else{MemberVerification['findOne']({'member':_0x3379cb['member'][_0xd758('0xf')],'type':_0xd758('0x19')},(_0x3cb8f2,_0x140196)=>{try{if(_0x140196){fs[_0xd758('0x14')](path[_0xd758('0x15')](Config[_0xd758('0x16')],_0xd758('0x1b'),_0x140196[_0xd758('0xb')]),()=>{});fs[_0xd758('0x14')](path[_0xd758('0x15')](Config[_0xd758('0x16')],'verification',_0x140196['image']),()=>{});MemberVerification[_0xd758('0x1c')](_0x140196[_0xd758('0xf')],()=>{});}}catch(_0x2b8c17){}MemberVerification[_0xd758('0x1d')]({'member':_0x3379cb[_0xd758('0xe')]['_id'],'type':_0xd758('0x19'),'image':_0x23cd2f},()=>{_0x4ccc69[_0xd758('0x17')]({'status':!![],'file':_0x23cd2f});});});}});})['catch'](_0x46275a=>{if(_0x3379cb['file']){fs[_0xd758('0x13')](_0x3379cb['file'][_0xd758('0x2')]);}_0x4ccc69[_0xd758('0x17')]({'status':![],'err':_0x46275a});});});this['postM']('/orther-photo.html',upload[_0xd758('0x7')](_0xd758('0x8')),(_0x2b6a80,_0xc82fb)=>{_0x2b6a80[_0xd758('0x9')](_0xd758('0x8'),__(_0xd758('0xa')))[_0xd758('0xb')](_0x2b6a80[_0xd758('0x8')],!![])[_0xd758('0xc')](_0xd758('0x1e'),_0x2b6a80[_0xd758('0xe')][_0xd758('0xf')]);;_0x2b6a80['asyncValidationErrors']()[_0xd758('0x11')](()=>{LbImage[_0xd758('0x1a')](_0x2b6a80[_0xd758('0x8')],_0xd758('0x12'),{'thumb':{'width':0x96,'height':![]}},(_0x3697f3,_0x9664a7)=>{if(_0x3697f3){if(_0x2b6a80[_0xd758('0x8')]){fs[_0xd758('0x13')](_0x2b6a80[_0xd758('0x8')][_0xd758('0x2')]);}_0xc82fb[_0xd758('0x17')]({'status':![],'msg':_0x3697f3});}else{MemberVerification[_0xd758('0x1f')]({'member':_0x2b6a80['member']['_id'],'type':_0xd758('0x1e')},(_0x5df2f5,_0x1b49dc)=>{try{if(_0x1b49dc){fs[_0xd758('0x14')](path['resolve'](Config[_0xd758('0x16')],'verification/thumb',_0x1b49dc[_0xd758('0xb')]),()=>{});fs['unlink'](path['resolve'](Config['Upload_Dir'],_0xd758('0x12'),_0x1b49dc[_0xd758('0xb')]),()=>{});MemberVerification[_0xd758('0x1c')](_0x1b49dc[_0xd758('0xf')],()=>{});}}catch(_0x143fba){}MemberVerification['create']({'member':_0x2b6a80[_0xd758('0xe')]['_id'],'type':_0xd758('0x1e'),'image':_0x9664a7},()=>{_0xc82fb[_0xd758('0x17')]({'status':!![],'file':_0x9664a7});});});}});})[_0xd758('0x18')](_0x5e8a24=>{if(_0x2b6a80[_0xd758('0x8')]){fs['unlinkSync'](_0x2b6a80[_0xd758('0x8')][_0xd758('0x2')]);}_0xc82fb['json']({'status':![],'err':_0x5e8a24});});});this[_0xd758('0x5')]('/photo-of-address.html',upload[_0xd758('0x7')](_0xd758('0x8')),(_0x26cbe9,_0x12c563)=>{_0x26cbe9[_0xd758('0x9')](_0xd758('0x8'),__('photoNotValid'))[_0xd758('0xb')](_0x26cbe9[_0xd758('0x8')],!![])['checkMemberVerification'](_0xd758('0x20'),_0x26cbe9[_0xd758('0xe')]['_id']);;_0x26cbe9[_0xd758('0x10')]()[_0xd758('0x11')](()=>{LbImage[_0xd758('0x1a')](_0x26cbe9['file'],_0xd758('0x12'),{'thumb':{'width':0x96,'height':![]}},(_0x1e5bf3,_0x30afb1)=>{if(_0x1e5bf3){if(_0x26cbe9[_0xd758('0x8')]){fs[_0xd758('0x13')](_0x26cbe9[_0xd758('0x8')][_0xd758('0x2')]);}_0x12c563[_0xd758('0x17')]({'status':![],'msg':_0x1e5bf3});}else{MemberVerification[_0xd758('0x1f')]({'member':_0x26cbe9[_0xd758('0xe')][_0xd758('0xf')],'type':_0xd758('0x20')},(_0x15ddb0,_0xf64e88)=>{try{if(_0xf64e88){fs[_0xd758('0x14')](path['resolve'](Config[_0xd758('0x16')],_0xd758('0x1b'),_0xf64e88[_0xd758('0xb')]),()=>{});fs['unlink'](path[_0xd758('0x15')](Config[_0xd758('0x16')],'verification',_0xf64e88[_0xd758('0xb')]),()=>{});MemberVerification[_0xd758('0x1c')](_0xf64e88[_0xd758('0xf')],()=>{});}}catch(_0x319948){}MemberVerification[_0xd758('0x1d')]({'member':_0x26cbe9['member']['_id'],'type':_0xd758('0x20'),'image':_0x30afb1},()=>{_0x12c563['json']({'status':!![],'file':_0x30afb1});});});}});})['catch'](_0x418791=>{if(_0x26cbe9[_0xd758('0x8')]){fs['unlinkSync'](_0x26cbe9[_0xd758('0x8')]['path']);}_0x12c563[_0xd758('0x17')]({'status':![],'err':_0x418791});});});this[_0xd758('0x5')]('/btc-address.html',upload[_0xd758('0x7')](_0xd758('0x8')),(_0x11e725,_0x2f1bd6)=>{_0x11e725['checkBody']('file',__('photoNotValid'))[_0xd758('0xb')](_0x11e725['file'],!![])[_0xd758('0xc')](_0xd758('0x21'),_0x11e725[_0xd758('0xe')][_0xd758('0xf')]);;_0x11e725[_0xd758('0x10')]()[_0xd758('0x11')](()=>{LbImage['Crop'](_0x11e725[_0xd758('0x8')],'verification',{'thumb':{'width':0x96,'height':![]}},(_0x275f8c,_0x1091ed)=>{if(_0x275f8c){if(_0x11e725[_0xd758('0x8')]){fs['unlinkSync'](_0x11e725[_0xd758('0x8')]['path']);}_0x2f1bd6[_0xd758('0x17')]({'status':![],'msg':_0x275f8c});}else{MemberVerification['findOne']({'member':_0x11e725[_0xd758('0xe')]['_id'],'type':_0xd758('0x21')},(_0x1e548c,_0x4a133f)=>{try{if(_0x4a133f){fs[_0xd758('0x14')](path[_0xd758('0x15')](Config[_0xd758('0x16')],_0xd758('0x1b'),_0x4a133f[_0xd758('0xb')]),()=>{});fs[_0xd758('0x14')](path[_0xd758('0x15')](Config['Upload_Dir'],'verification',_0x4a133f[_0xd758('0xb')]),()=>{});MemberVerification[_0xd758('0x1c')](_0x4a133f[_0xd758('0xf')],()=>{});}}catch(_0x13d72d){}MemberVerification[_0xd758('0x1d')]({'member':_0x11e725['member'][_0xd758('0xf')],'type':_0xd758('0x21'),'image':_0x1091ed},()=>{_0x2f1bd6[_0xd758('0x17')]({'status':!![],'file':_0x1091ed});});});}});})[_0xd758('0x18')](_0x3a0622=>{if(_0x11e725[_0xd758('0x8')]){fs[_0xd758('0x13')](_0x11e725[_0xd758('0x8')][_0xd758('0x2')]);}_0x2f1bd6[_0xd758('0x17')]({'status':![],'err':_0x3a0622});});});}}module[_0xd758('0x22')]=new DefaultMemberPhotoVerification()[_0xd758('0x23')];