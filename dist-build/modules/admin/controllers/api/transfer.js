var _0xb294=['plus','type','update','balance','statistics','transfer.','transfer','minus','amount','DoUpdateInfo','_id','confirm','memberReceived','received.','json','get','findAll','forEach','push','extend','clone','pick','fullname','username','all','then','omit','results','query','exports','router','./../../../../core/core','./../../../../models/Member','./../../../../models/MemberBalance','./../../../../models/MemberStatistics','config','index','put','body','findById','memberSend'];(function(_0x3c94fd,_0x37e39d){var _0xd01b3=function(_0x40f380){while(--_0x40f380){_0x3c94fd['push'](_0x3c94fd['shift']());}};_0xd01b3(++_0x37e39d);}(_0xb294,0x1e2));var _0x4b29=function(_0x34c2a1,_0x16eb5a){_0x34c2a1=_0x34c2a1-0x0;var _0x165325=_0xb294[_0x34c2a1];return _0x165325;};'use strict';const core=require(_0x4b29('0x0'));const Member=require(_0x4b29('0x1'));const MemberBalance=require(_0x4b29('0x2'));const MemberStatistics=require(_0x4b29('0x3'));const Transfer=require('./../../../../models/Transfer');var bigNumber=require('bignumber.js');bigNumber[_0x4b29('0x4')]({'DECIMAL_PLACES':0x8,'ERRORS':![],'ROUNDING_MODE':0x1});class AdminApiTransfer extends core{constructor(){super();this[_0x4b29('0x5')]();}[_0x4b29('0x5')](){this[_0x4b29('0x6')]('/',(_0x1fe0bd,_0x43f014)=>{Transfer['findOne']({'_id':_0x1fe0bd[_0x4b29('0x7')]['transferid'],'active':![],'cancel':![]},(_0x473e0e,_0x5d9fed)=>{if(_0x5d9fed){let _0x50614a=()=>{Member[_0x4b29('0x8')](_0x5d9fed[_0x4b29('0x9')],(_0x34a50f,_0x1dc9e1)=>{if(_0x1dc9e1){MemberBalance[_0x4b29('0x8')](_0x1dc9e1['balance'],(_0xf49fd6,_0x57f401)=>{let _0x358972={};_0x358972[_0x5d9fed['type']]=new bigNumber(_0x5d9fed['amount'])[_0x4b29('0xa')](_0x57f401[_0x5d9fed[_0x4b29('0xb')]]);MemberBalance[_0x4b29('0xc')](_0x1dc9e1[_0x4b29('0xd')],_0x358972,()=>{MemberStatistics[_0x4b29('0x8')](_0x1dc9e1[_0x4b29('0xe')],(_0xaf6c2c,_0x4bca65)=>{let _0x11176c={};_0x11176c[_0x4b29('0xf')+_0x5d9fed[_0x4b29('0xb')]]=new bigNumber(_0x4bca65[_0x4b29('0x10')][_0x5d9fed[_0x4b29('0xb')]])[_0x4b29('0x11')](_0x5d9fed[_0x4b29('0x12')]);MemberStatistics[_0x4b29('0xc')](_0x1dc9e1[_0x4b29('0xe')],_0x11176c,()=>{this[_0x4b29('0x13')](_0x1dc9e1[_0x4b29('0x14')]);});});});});}});Transfer[_0x4b29('0xc')](_0x5d9fed[_0x4b29('0x14')],{'cancel':!![],'code':''},()=>{});};if(_0x1fe0bd[_0x4b29('0x7')][_0x4b29('0xb')]==_0x4b29('0x15')){Member[_0x4b29('0x8')](_0x5d9fed[_0x4b29('0x16')],(_0x2cf0b7,_0x1a9ceb)=>{if(_0x1a9ceb){MemberBalance['findById'](_0x1a9ceb[_0x4b29('0xd')],(_0x4af04f,_0x334800)=>{let _0x3f0eff={};_0x3f0eff[_0x5d9fed[_0x4b29('0xb')]]=new bigNumber(_0x5d9fed[_0x4b29('0x12')])[_0x4b29('0xa')](_0x334800[_0x5d9fed[_0x4b29('0xb')]]);MemberBalance['update'](_0x1a9ceb['balance'],_0x3f0eff,()=>{MemberStatistics[_0x4b29('0x8')](_0x1a9ceb[_0x4b29('0xe')],(_0xcd40a9,_0x4b2e6f)=>{let _0xe19aab={};_0xe19aab['balance.'+_0x5d9fed[_0x4b29('0xb')]]=new bigNumber(_0x5d9fed['amount'])[_0x4b29('0xa')](_0x4b2e6f[_0x4b29('0xd')][_0x5d9fed['type']]);_0xe19aab[_0x4b29('0x17')+_0x5d9fed['type']]=new bigNumber(_0x5d9fed[_0x4b29('0x12')])[_0x4b29('0xa')](_0x4b2e6f['received'][_0x5d9fed[_0x4b29('0xb')]]);MemberStatistics[_0x4b29('0xc')](_0x1a9ceb[_0x4b29('0xe')],_0xe19aab,()=>{this['DoUpdateInfo'](_0x1a9ceb[_0x4b29('0x14')]);});});});Transfer[_0x4b29('0xc')](_0x5d9fed[_0x4b29('0x14')],{'active':!![],'code':''},()=>{});});}else{_0x50614a();}});}else{_0x50614a();}setTimeout(()=>{_0x43f014[_0x4b29('0x18')]({'status':![]});});}else{_0x43f014[_0x4b29('0x18')]({'status':![]});}});});this[_0x4b29('0x19')]('/',(_0x58fd20,_0x288786)=>{Transfer[_0x4b29('0x1a')]((_0xdf1bd3,_0x45435c,_0x11345c)=>{if(_0x45435c&&_0x45435c['length']){let _0x563714=[];_0x45435c[_0x4b29('0x1b')]((_0x17d95a,_0x4f3c38)=>{_0x563714[_0x4b29('0x1c')](new Promise((_0x237261,_0xc987df)=>{Member['findById'](_0x17d95a[_0x4b29('0x16')],(_0x50caad,_0x3d67ae)=>{_0x45435c[_0x4f3c38]=this['_'][_0x4b29('0x1d')](this[_0x4b29('0x1e')](_0x45435c[_0x4f3c38]),{'received':this['_'][_0x4b29('0x1f')](_0x3d67ae,'username',_0x4b29('0x20'))});Member[_0x4b29('0x8')](_0x17d95a[_0x4b29('0x9')],(_0x11ffb7,_0x4d4255)=>{_0x45435c[_0x4f3c38]=this['_'][_0x4b29('0x1d')](_0x45435c[_0x4f3c38],{'send':this['_'][_0x4b29('0x1f')](_0x4d4255,_0x4b29('0x21'),'fullname')});_0x237261();});});}));});Promise[_0x4b29('0x22')](_0x563714)[_0x4b29('0x23')](()=>{_0x288786[_0x4b29('0x18')]({'status':!![],'transfer':_0x45435c,'pagination':this['_']['omit'](_0x11345c,'results')});});}else{_0x288786[_0x4b29('0x18')]({'status':!![],'transfer':_0x45435c,'pagination':this['_'][_0x4b29('0x24')](_0x11345c,_0x4b29('0x25'))});}},+_0x58fd20[_0x4b29('0x26')]['per_page']||0x14,+_0x58fd20[_0x4b29('0x26')]['page']||0x0,{'create':-0x1});});}}module[_0x4b29('0x27')]=new AdminApiTransfer()[_0x4b29('0x28')];