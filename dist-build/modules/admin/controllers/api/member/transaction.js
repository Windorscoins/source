var _0x553a=['index','findById','memberid','body','amount','statistics','type','plus','balance','adminTransfer','balance.','updateQ','json','_id','admin','DoUpdateInfo','exports','./../../../../../core/core','./../../../../../models/Member','./../../../../../models/MemberStatistics'];(function(_0x1c6494,_0x322586){var _0x4be989=function(_0x472010){while(--_0x472010){_0x1c6494['push'](_0x1c6494['shift']());}};_0x4be989(++_0x322586);}(_0x553a,0x89));var _0xa553=function(_0x292ff6,_0x2e8e23){_0x292ff6=_0x292ff6-0x0;var _0x204dc6=_0x553a[_0x292ff6];return _0x204dc6;};'use strict';const Core=require(_0xa553('0x0'));const Member=require(_0xa553('0x1'));const MemberBalance=require('./../../../../../models/MemberBalance');const MemberTransaction=require('./../../../../../models/MemberTransaction');const MemberStatistics=require(_0xa553('0x2'));var bigNumber=require('bignumber.js');bigNumber['config']({'DECIMAL_PLACES':0x8,'ERRORS':![],'ROUNDING_MODE':0x1});class AdminMemberEdit extends Core{constructor(){super();this[_0xa553('0x3')]();}['index'](){this['post']('/',(_0x18da5d,_0x3da5c7)=>{Member[_0xa553('0x4')](_0x18da5d['body'][_0xa553('0x5')],(_0x5f09d8,_0x318691)=>{if(_0x318691&&+_0x18da5d[_0xa553('0x6')][_0xa553('0x7')]){MemberBalance['findById'](_0x318691['balance'],(_0xc275e6,_0x58c170)=>{MemberStatistics[_0xa553('0x4')](_0x318691[_0xa553('0x8')],(_0x137813,_0x47d33d)=>{let _0xad89be={};_0xad89be[_0x18da5d[_0xa553('0x6')][_0xa553('0x9')]]=new bigNumber(_0x18da5d['body'][_0xa553('0x7')])[_0xa553('0xa')](_0x58c170[_0x18da5d[_0xa553('0x6')]['type']]);MemberBalance['updateQ']({'_id':_0x318691[_0xa553('0xb')]},_0xad89be,(_0x26dcc5,_0x14b019)=>{let _0x37dd93={};_0x37dd93['adminTransfer.'+_0x18da5d[_0xa553('0x6')]['type']]=new bigNumber(_0x18da5d[_0xa553('0x6')]['amount'])['plus'](_0x47d33d[_0xa553('0xc')][_0x18da5d['body'][_0xa553('0x9')]]);_0x37dd93[_0xa553('0xd')+_0x18da5d[_0xa553('0x6')]['type']]=new bigNumber(_0x18da5d[_0xa553('0x6')][_0xa553('0x7')])['plus'](_0x47d33d[_0xa553('0xb')][_0x18da5d[_0xa553('0x6')]['type']]);MemberStatistics[_0xa553('0xe')]({'_id':_0x318691['statistics']},_0x37dd93,(_0x309eb7,_0x18af22)=>{if(_0x309eb7){_0x3da5c7[_0xa553('0xf')]({'status':![],'err':[{'params':_0xa553('0x7'),'msg':_0x309eb7}]});}else{MemberTransaction['create']({'memberid':_0x318691[_0xa553('0x10')],'from':_0xa553('0x11'),'description':_0x18da5d[_0xa553('0x6')]['description'],'amount':+_0x18da5d[_0xa553('0x6')]['amount'],'type':_0x18da5d['body'][_0xa553('0x9')]},()=>{this[_0xa553('0x12')](_0x318691['_id']);_0x3da5c7[_0xa553('0xf')]({'status':!![]});});}});});});});}else{_0x3da5c7[_0xa553('0xf')]({'status':![]});}});});}}module[_0xa553('0x13')]=new AdminMemberEdit()['router'];