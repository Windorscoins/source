var _0x05ff=['./../../../../config/config','loadDefault','body','query','x-access-token','headers','cookies','verify','jwt','username','password','json','Token\x20is\x20not\x20valid','exports'];(function(_0x5b4826,_0x4a3682){var _0xd64a1a=function(_0x52f8d9){while(--_0x52f8d9){_0x5b4826['push'](_0x5b4826['shift']());}};_0xd64a1a(++_0x4a3682);}(_0x05ff,0xee));var _0xf05f=function(_0x31cca4,_0x398908){_0x31cca4=_0x31cca4-0x0;var _0x1df011=_0x05ff[_0x31cca4];return _0x1df011;};'use strict';const Config=require(_0xf05f('0x0'));const User=require('./../../../../models/User');const JWT=require('jsonwebtoken');class Default{constructor(){}[_0xf05f('0x1')](_0x30400a,_0x47af4c,_0x68ef73){let _0x2b67cf=_0x30400a[_0xf05f('0x2')]['x-access-token']||_0x30400a[_0xf05f('0x3')][_0xf05f('0x4')]||_0x30400a[_0xf05f('0x5')]['x-access-token']||_0x30400a[_0xf05f('0x6')][_0xf05f('0x4')];if(_0x2b67cf){JWT[_0xf05f('0x7')](_0x2b67cf,Config[_0xf05f('0x8')],(_0x119970,_0x34b8d3)=>{if(_0x34b8d3&&_0x34b8d3[_0xf05f('0x9')]&&_0x34b8d3[_0xf05f('0xa')]){User['findOne']({'username':_0x34b8d3[_0xf05f('0x9')]},(_0x30cf7e,_0x5e2131)=>{if(_0x5e2131){JWT[_0xf05f('0x7')](_0x5e2131[_0xf05f('0xa')],Config[_0xf05f('0x8')],(_0x5ee76f,_0x1dc964)=>{if(_0x1dc964[_0xf05f('0xa')]==_0x34b8d3[_0xf05f('0xa')]){_0x68ef73();}else{_0x47af4c[_0xf05f('0xb')]({'status':![],'login':!![],'msg':_0xf05f('0xc')});}});}else{_0x47af4c[_0xf05f('0xb')]({'status':![],'login':!![],'msg':'Token\x20is\x20not\x20valid'});}});}else{_0x47af4c[_0xf05f('0xb')]({'status':![],'login':!![],'msg':_0xf05f('0xc')});}});}else{_0x47af4c[_0xf05f('0xb')]({'status':![],'login':!![],'msg':_0xf05f('0xc')});}}}module[_0xf05f('0xd')]=new Default()['loadDefault'];