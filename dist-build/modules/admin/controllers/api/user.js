var _0x7a54=['get','push','pick','omit','results','per_page','page','equals','passwordConfirm','asyncValidationErrors','then','Phone\x20is\x20required','update','toString','delete','exports','./../../../../core/core','./../../../../models/User','./../../../../config/config','index','post','checkBody','Username\x20is\x20required','notEmpty','withMessage','Password\x20is\x20required','body','Password\x20confirm\x20is\x20not\x20correct','fullname','Fullname\x20is\x20required','phone','matches','Phone\x20is\x20not\x20valid','UserPhoneExists','Phone\x20is\x20exists','Email\x20is\x20required','UserEmailExists','Email\x20is\x20exists','Email\x20is\x20not\x20valid','create','username','sign','password','jwt','json','catch','/edit.html','query','userid','findById','email','_id'];(function(_0x40579e,_0x4a9efa){var _0x454ca0=function(_0x47f7fa){while(--_0x47f7fa){_0x40579e['push'](_0x40579e['shift']());}};_0x454ca0(++_0x4a9efa);}(_0x7a54,0x1e4));var _0x47a5=function(_0x40d184,_0x3df3d3){_0x40d184=_0x40d184-0x0;var _0x1cee4f=_0x7a54[_0x40d184];return _0x1cee4f;};'use strict';const core=require(_0x47a5('0x0'));const User=require(_0x47a5('0x1'));const JWT=require('jsonwebtoken');const Config=require(_0x47a5('0x2'));class AdminApiUser extends core{constructor(){super();this[_0x47a5('0x3')]();}[_0x47a5('0x3')](){this[_0x47a5('0x4')]('/',(_0xfdf934,_0x545a97)=>{_0xfdf934[_0x47a5('0x5')]('username',_0x47a5('0x6'))[_0x47a5('0x7')]()['UserUsernameExists']()[_0x47a5('0x8')]('Username\x20is\x20exists');_0xfdf934['checkBody']('password',_0x47a5('0x9'))[_0x47a5('0x7')]()['equals'](_0xfdf934[_0x47a5('0xa')]['passwordConfirm'])['withMessage'](_0x47a5('0xb'));_0xfdf934[_0x47a5('0x5')](_0x47a5('0xc'),_0x47a5('0xd'))[_0x47a5('0x7')]();_0xfdf934[_0x47a5('0x5')](_0x47a5('0xe'),'Phone\x20is\x20required')[_0x47a5('0x7')]()[_0x47a5('0xf')](/[0-9]{9,13}/i)[_0x47a5('0x8')](_0x47a5('0x10'))[_0x47a5('0x11')]()[_0x47a5('0x8')](_0x47a5('0x12'));_0xfdf934[_0x47a5('0x5')]('email',_0x47a5('0x13'))[_0x47a5('0x7')]()[_0x47a5('0x14')]()[_0x47a5('0x8')](_0x47a5('0x15'))['isEmail']()['withMessage'](_0x47a5('0x16'));_0xfdf934['asyncValidationErrors']()['then'](()=>{User[_0x47a5('0x17')]({'username':_0xfdf934[_0x47a5('0xa')][_0x47a5('0x18')],'password':JWT[_0x47a5('0x19')]({'password':_0xfdf934[_0x47a5('0xa')][_0x47a5('0x1a')]},Config[_0x47a5('0x1b')]),'fullname':_0xfdf934[_0x47a5('0xa')][_0x47a5('0xc')],'phone':_0xfdf934['body'][_0x47a5('0xe')],'email':_0xfdf934[_0x47a5('0xa')]['email']},(_0x2b0360,_0x1f03f7)=>{if(_0x2b0360){_0x545a97[_0x47a5('0x1c')]({'status':![],'msg':_0x2b0360['toString']()});}else{_0x545a97[_0x47a5('0x1c')]({'status':!![]});}});})[_0x47a5('0x1d')](_0x23db32=>{_0x545a97[_0x47a5('0x1c')]({'status':![],'err':_0x23db32});});});this['get'](_0x47a5('0x1e'),(_0x385687,_0x513981)=>{if(_0x385687[_0x47a5('0x1f')][_0x47a5('0x20')]){User[_0x47a5('0x21')](_0x385687[_0x47a5('0x1f')][_0x47a5('0x20')],(_0x50bf17,_0x53078a)=>{if(_0x53078a){_0x513981[_0x47a5('0x1c')]({'status':!![],'user':this['_']['pick'](_0x53078a,_0x47a5('0x18'),'fullname',_0x47a5('0x22'),_0x47a5('0xe'),_0x47a5('0x17'),_0x47a5('0x23'))});}else{_0x513981[_0x47a5('0x1c')]({'status':![]});}});}else{_0x513981[_0x47a5('0x1c')]({'status':![]});}});this[_0x47a5('0x24')]('/',(_0x136b14,_0x16631f)=>{let _0x361bfa={};let _0x1127f8=(_0x11a4fa,_0x3ad507,_0x528582)=>{let _0x243210=[];_0x3ad507['forEach'](_0x2ef875=>{_0x243210[_0x47a5('0x25')](this['_'][_0x47a5('0x26')](_0x2ef875,'username',_0x47a5('0xc'),_0x47a5('0x22'),_0x47a5('0xe'),_0x47a5('0x17'),'_id'));});_0x16631f['json']({'status':!![],'user':_0x243210,'pagination':this['_'][_0x47a5('0x27')](_0x528582,_0x47a5('0x28'))});};if(_0x136b14['query']['q']){User['fulltext'](_0x136b14[_0x47a5('0x1f')]['q'],(_0x51544e,_0x57bff6,_0x42f70c)=>{_0x1127f8(_0x51544e,_0x57bff6,_0x42f70c);},+_0x136b14['query'][_0x47a5('0x29')]||0x14,+_0x136b14[_0x47a5('0x1f')]['page']||0x0);}else{User['findAllQ'](_0x361bfa,(_0x274e34,_0x5910bb,_0x403028)=>{_0x1127f8(_0x274e34,_0x5910bb,_0x403028);},+_0x136b14[_0x47a5('0x1f')][_0x47a5('0x29')]||0x14,+_0x136b14['query'][_0x47a5('0x2a')]||0x0,{'create':-0x1});}});this['put']('/change-password.html',(_0x65542e,_0x5a8a7c)=>{_0x65542e[_0x47a5('0x5')]('password',_0x47a5('0x9'))[_0x47a5('0x7')]()[_0x47a5('0x2b')](_0x65542e[_0x47a5('0xa')][_0x47a5('0x2c')])[_0x47a5('0x8')](_0x47a5('0xb'));_0x65542e[_0x47a5('0x2d')]()[_0x47a5('0x2e')](()=>{User['update'](_0x65542e[_0x47a5('0xa')][_0x47a5('0x20')],{'password':JWT['sign']({'password':_0x65542e[_0x47a5('0xa')][_0x47a5('0x1a')]},Config[_0x47a5('0x1b')])},(_0x49c4b5,_0x101f70)=>{if(_0x49c4b5){_0x5a8a7c[_0x47a5('0x1c')]({'status':![],'msg':_0x49c4b5['toString']()});}else{_0x5a8a7c[_0x47a5('0x1c')]({'status':!![]});}});})[_0x47a5('0x1d')](_0x54ae35=>{_0x5a8a7c['json']({'status':![],'err':_0x54ae35});});});this['put']('/',(_0x12d9f2,_0x5c569e)=>{_0x12d9f2[_0x47a5('0x5')](_0x47a5('0xc'),_0x47a5('0xd'))[_0x47a5('0x7')]();_0x12d9f2[_0x47a5('0x5')](_0x47a5('0xe'),_0x47a5('0x2f'))[_0x47a5('0x7')]()[_0x47a5('0xf')](/[0-9]{9,13}/i)[_0x47a5('0x8')](_0x47a5('0x10'))[_0x47a5('0x11')](_0x12d9f2[_0x47a5('0xa')]['userid'])[_0x47a5('0x8')](_0x47a5('0x12'));_0x12d9f2[_0x47a5('0x5')](_0x47a5('0x22'),'Email\x20is\x20required')[_0x47a5('0x7')]()['UserEmailExists'](_0x12d9f2['body']['userid'])['withMessage'](_0x47a5('0x15'))['isEmail']()[_0x47a5('0x8')](_0x47a5('0x16'));_0x12d9f2[_0x47a5('0x2d')]()['then'](()=>{User[_0x47a5('0x30')](_0x12d9f2[_0x47a5('0xa')]['userid'],{'fullname':_0x12d9f2['body'][_0x47a5('0xc')],'phone':_0x12d9f2['body'][_0x47a5('0xe')],'email':_0x12d9f2[_0x47a5('0xa')][_0x47a5('0x22')]},(_0xd75ca3,_0x34a9ae)=>{if(_0xd75ca3){_0x5c569e[_0x47a5('0x1c')]({'status':![],'msg':_0xd75ca3[_0x47a5('0x31')]()});}else{_0x5c569e[_0x47a5('0x1c')]({'status':!![]});}});})[_0x47a5('0x1d')](_0x162fa0=>{_0x5c569e[_0x47a5('0x1c')]({'status':![],'err':_0x162fa0});});});this[_0x47a5('0x32')]('/',(_0xe28d76,_0x3574d4)=>{User[_0x47a5('0x32')](_0xe28d76[_0x47a5('0x1f')]['userid'],()=>{_0x3574d4[_0x47a5('0x1c')]({'status':!![]});});});}}module[_0x47a5('0x33')]=new AdminApiUser()['router'];