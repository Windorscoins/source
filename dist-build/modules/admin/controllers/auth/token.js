var _0x9427=['fullname','phone','email','sign','Token\x20is\x20not\x20valid','exports','router','./../../../../core/core','jsonwebtoken','./../../../../config/config','./../../../../models/User','index','post','token','verify','jwt','username','password','findOne','json','pick'];(function(_0x24498e,_0x4f4961){var _0xdd4b5f=function(_0x4dd14c){while(--_0x4dd14c){_0x24498e['push'](_0x24498e['shift']());}};_0xdd4b5f(++_0x4f4961);}(_0x9427,0xee));var _0x7942=function(_0x4f7409,_0x40dbe7){_0x4f7409=_0x4f7409-0x0;var _0x45cdce=_0x9427[_0x4f7409];return _0x45cdce;};'use strict';const Core=require(_0x7942('0x0'));const JWT=require(_0x7942('0x1'));const Config=require(_0x7942('0x2'));const User=require(_0x7942('0x3'));class AdminAuthToken extends Core{constructor(){super();this[_0x7942('0x4')]();}[_0x7942('0x4')](){this[_0x7942('0x5')]('/',(_0x340ff5,_0x5c6b47)=>{let _0x5e764b=_0x340ff5['body'][_0x7942('0x6')];if(_0x5e764b){try{JWT[_0x7942('0x7')](_0x5e764b,Config[_0x7942('0x8')],(_0x240c40,_0x1f7365)=>{if(_0x1f7365&&_0x1f7365[_0x7942('0x9')]&&_0x1f7365[_0x7942('0xa')]){User[_0x7942('0xb')]({'username':_0x1f7365['username']},(_0x4d4e1e,_0x3c44f2)=>{if(_0x3c44f2){JWT[_0x7942('0x7')](_0x3c44f2[_0x7942('0xa')],Config[_0x7942('0x8')],(_0x6e91be,_0x2bfd37)=>{if(_0x2bfd37[_0x7942('0xa')]==_0x1f7365[_0x7942('0xa')]){_0x5c6b47[_0x7942('0xc')]({'status':!![],'user':this['_'][_0x7942('0xd')](_0x3c44f2,'username',_0x7942('0xe'),_0x7942('0xf'),_0x7942('0x10'),'create','_id'),'token':JWT[_0x7942('0x11')]({'username':_0x3c44f2[_0x7942('0x9')],'password':_0x1f7365[_0x7942('0xa')]},Config[_0x7942('0x8')])});}else{_0x5c6b47['json']({'status':![],'msg':_0x7942('0x12')});}});}else{_0x5c6b47[_0x7942('0xc')]({'status':![],'msg':'Token\x20is\x20not\x20valid'});}});}else{_0x5c6b47[_0x7942('0xc')]({'status':![],'msg':'Token\x20is\x20not\x20valid'});}});}catch(_0x3d97ee){_0x5c6b47['json']({'status':![],'msg':_0x7942('0x12')});}}else{_0x5c6b47[_0x7942('0xc')]({'status':![],'msg':_0x7942('0x12')});}});}}module[_0x7942('0x13')]=new AdminAuthToken()[_0x7942('0x14')];